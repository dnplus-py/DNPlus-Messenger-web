<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DNPlus Messenger</title>
    <link rel="stylesheet" href="estilos_chat.css">
</head>
<body>

    <div id="main-container" style="display: flex; flex-direction: column; height: 100vh; overflow: hidden;">
        <div id="zona-cabecera"></div>

        <div id="chat-box" style="flex: 1; overflow-y: auto;"></div>

        <div id="zona-input"></div>
    </div>

    <div id="modal-opciones" class="modal-bottom" style="display:none;">
        <div class="menu-item" onclick="confirmarVaciarChat()"><span>üóëÔ∏è</span> Vaciar chat</div>
        <div class="menu-item" onclick="abrirSelectorFondo()"><span>üñºÔ∏è</span> Fondo de pantalla</div>
        <div style="text-align:center; color:#ff4444; padding:15px; cursor:pointer;" onclick="cerrarModales()">Cancelar</div>
    </div>

    <div id="modal-colores" class="modal-bottom" style="display:none;">
        <div style="text-align:center; padding:20px;">
            <div class="color-circle" style="background:#0b141a" onclick="cambiarFondo('#0b141a')"></div>
            <div class="color-circle" style="background:#176f47" onclick="cambiarFondo('#176f47')"></div>
            <div class="color-circle" style="background:#075e54" onclick="cambiarFondo('#075e54')"></div>
            <div class="color-circle" style="background:#3e2723" onclick="cambiarFondo('#3e2723')"></div>
        </div>
        <div style="text-align:center; padding:15px; color:white; cursor:pointer;" onclick="cerrarModales()">Volver</div>
    </div>

    <div id="visor" style="display:none;" onclick="this.style.display='none'">
        <img id="img-zoom">
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-database-compat.js"></script>
    
    <script>
        // Configuraci√≥n Firebase
        const firebaseConfig = { 
            apiKey: "AIzaSyD2nZF5QC-Zti80xP1A518qbUPnhRru_9A", 
            databaseURL: "https://dnplus-messenger-pro-default-rtdb.firebaseio.com" 
        };
        firebase.initializeApp(firebaseConfig);

        // ENSAMBLADOR: Carga los archivos HTML hijos
        async function cargarPartes() {
            const h = await fetch('cabecera_chat.html');
            document.getElementById('zona-cabecera').innerHTML = await h.text();

            const i = await fetch('barra_input.html');
            document.getElementById('zona-input').innerHTML = await i.text();
            
            // Vincular eventos de audio tras cargar el HTML
            const btn = document.getElementById('btn-main');
            if(btn) {
                btn.onmousedown = iniciarGrabacion;
                btn.onmouseup = detenerGrabacion;
            }
        }
        cargarPartes();
    </script>

    <script src="chat_logic.js"></script>

</body>
</html>
