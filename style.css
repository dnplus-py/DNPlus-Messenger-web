<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>DNPlus Messenger</title>
    <link rel="stylesheet" href="estilos_chat.css">
    <style>
        /* RESET CR√çTICO: Sin esto, la cabecera siempre se ver√° mal */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            background-color: #0b141a;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden; /* Evita rebotes feos */
        }

        /* Contenedores maestros */
        #zona-cabecera { width: 100%; min-height: 60px; }
        #chat-box { flex: 1; overflow-y: auto; padding: 10px; }
        #zona-input { width: 100%; }

        .modal-bottom {
            display: none;
            position: fixed;
            bottom: 0;
            width: 100%;
            background: #232d36;
            border-radius: 20px 20px 0 0;
            z-index: 5000;
            padding: 10px 0;
        }
    </style>
</head>
<body>

    <div id="zona-cabecera"></div>

    <div id="chat-box"></div>

    <div id="zona-input"></div>

    <div id="modal-opciones" class="modal-bottom">
        <div style="padding:15px 25px; color:white;" onclick="confirmarVaciarChat()">üóëÔ∏è Vaciar chat</div>
        <div style="padding:15px 25px; color:white;" onclick="abrirSelectorFondo()">üñºÔ∏è Fondo de pantalla</div>
        <div style="text-align:center; color:#ff4444; padding:15px;" onclick="document.getElementById('modal-opciones').style.display='none'">Cancelar</div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-database-compat.js"></script>
    
    <script>
        // Tu config de siempre
        const firebaseConfig = { 
            apiKey: "AIzaSyD2nZF5QC-Zti80xP1A518qbUPnhRru_9A", 
            databaseURL: "https://dnplus-messenger-pro-default-rtdb.firebaseio.com" 
        };
        firebase.initializeApp(firebaseConfig);

        // Cargador de archivos externos
        async function ensamblarTodo() {
            const h = await fetch('cabecera_chat.html');
            document.getElementById('zona-cabecera').innerHTML = await h.text();

            const i = await fetch('barra_input.html');
            document.getElementById('zona-input').innerHTML = await i.text();
            
            // Si el JS ya carg√≥, vinculamos el audio
            if(window.iniciarGrabacion) {
                const b = document.getElementById('btn-main');
                if(b){ b.onmousedown = iniciarGrabacion; b.onmouseup = detenerGrabacion; }
            }
        }
        ensamblarTodo();
    </script>
    <script src="chat_logic.js"></script>
</body>
</html>
