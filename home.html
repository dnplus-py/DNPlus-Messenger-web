<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DNPlus - David Oviedo</title>
    <style>
        /* 1. VARIABLES DE COLOR PARA NO PERDER EL CONTROL */
        :root {
            --verde-dn: #00a884;
            --header-dn: #085f56;
            --fondo-dn: #0b141a;
            --texto-gris: #8696a0;
        }

        body { 
            margin: 0; 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background-color: var(--fondo-dn); 
            color: white; 
            overflow: hidden; /* Evita que toda la pantalla se mueva */
        }

        /* 2. CABECERA FIJA */
        .header { 
            background-color: var(--header-dn); 
            height: 100px; 
            display: flex; 
            flex-direction: column; 
            justify-content: space-between;
            padding: 10px 15px 0 15px;
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .header-top { display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 22px; font-weight: bold; }

        /* PESTA√ëAS */
        .tabs { display: flex; text-align: center; }
        .tab { 
            flex: 1; 
            padding: 12px 0; 
            color: rgba(255,255,255,0.6); 
            font-weight: bold; 
            cursor: pointer; 
            border-bottom: 3px solid transparent;
            transition: 0.3s;
        }
        .tab.active { 
            color: white; 
            border-bottom: 3px solid white; 
        }

        /* 3. AREA DE CONTENIDO (LO QUE CAMBIA) */
        #main-view { 
            height: calc(100vh - 110px); 
            overflow-y: auto; 
            width: 100%;
        }

        /* 4. BOTONES FLOTANTES (LOS TENEMOS ATADOS AQU√ç) */
        .fab-master {
            position: fixed;
            bottom: 30px;
            right: 25px;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background-color: var(--verde-dn);
            color: white;
            display: none; /* Se controla por JS */
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.4);
            cursor: pointer;
            z-index: 2000;
            border: none;
        }
    </style>
</head>
<body>

    <div class="header">
        <div class="header-top">
            <div class="logo">DNPlus</div>
            <div style="display: flex; gap: 20px; font-size: 18px; cursor: pointer;">
                <span>üîç</span>
                <span onclick="toggleAjustes()">‚ãÆ</span>
            </div>
        </div>
        <div class="tabs">
            <div class="tab active" id="t-chats" onclick="navegar('chats')">Chats</div>
            <div class="tab" id="t-estados" onclick="navegar('estados')">Estados</div>
            <div class="tab" id="t-llamadas" onclick="navegar('llamadas')">Llamadas</div>
        </div>
    </div>

    <div id="main-view">
        </div>

    <button id="fab-chats" class="fab-master" onclick="location.href='lista_contactos.html'">üí¨</button>
    <button id="fab-estados" class="fab-master" onclick="document.getElementById('file-estado').click()">üì∑</button>
    <button id="fab-llamadas" class="fab-master" onclick="location.href='crear_new_contacto.html'">‚ûï</button>

    <script>
        function navegar(seccion) {
            const vista = document.getElementById("main-view");
            
            // 1. Cambiar visual de pesta√±as
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.getElementById('t-' + seccion).classList.add('active');

            // 2. Control total de botones
            document.querySelectorAll('.fab-master').forEach(b => b.style.display = 'none');
            document.getElementById('fab-' + seccion).style.display = 'flex';

            // 3. Cargar la lista sin que se desarme el resto
            fetch(`lista_${seccion}.html`)
                .then(r => r.text())
                .then(html => {
                    vista.innerHTML = html;
                    
                    // Ejecutar scripts internos (Firebase, etc.)
                    const scripts = vista.querySelectorAll("script");
                    scripts.forEach(s => {
                        const scriptTag = document.createElement("script");
                        scriptTag.text = s.text;
                        document.body.appendChild(scriptTag).parentNode.removeChild(scriptTag);
                    });
                })
                .catch(err => {
                    vista.innerHTML = "<p style='text-align:center; margin-top:50px;'>Error al cargar lista.</p>";
                });
        }

        function toggleAjustes() {
            // Aqu√≠ llamar√≠as a tu modal de ajustes
            alert("Ajustes de David");
        }

        // Carga inicial
        window.onload = () => navegar('chats');
    </script>
</body>
</html>
